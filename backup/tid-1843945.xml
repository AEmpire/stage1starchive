<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0">
  <channel>
    <title>è¿˜åœ¨å¤åˆ¶é»è´´ï¼Ÿ50è¡ŒPythonä»£ç ï¼Œæ•™ä½ è·å–å…¬ä¼—å·å…¨éƒ¨æ–‡ç« </title>
    <link>https://bbs.saraba1st.com/2b/</link>
    <description>è¿˜åœ¨å¤åˆ¶é»è´´ï¼Ÿ50è¡ŒPythonä»£ç ï¼Œæ•™ä½ è·å–å…¬ä¼—å·å…¨éƒ¨æ–‡ç« </description>
    <docs>http://www.rssboard.org/rss-specification</docs>
    <generator>python-feedgen</generator>
    <lastBuildDate>Thu, 09 Jul 2020 19:19:15 +0000</lastBuildDate>
    <item>
      <title>è¿˜åœ¨å¤åˆ¶é»è´´ï¼Ÿ50è¡ŒPythonä»£ç ï¼Œæ•™ä½ è·å–å…¬ä¼—å·å…¨éƒ¨æ–‡ç« [0-50]</title>
      <link>https://bbs.saraba1st.com/2b/thread-1843945-1-1.html</link>
      <description>è¿˜åœ¨å¤åˆ¶é»è´´ï¼Ÿ50è¡ŒPythonä»£ç ï¼Œæ•™ä½ è·å–å…¬ä¼—å·å…¨éƒ¨æ–‡ç« &#13;
 æœ¬å¸–æœ€åç”± ç¥ç§˜ç”·å­A äº 2019-7-3 11:56 ç¼–è¾‘ 

http://blog.itpub.net/69923331/viewspace-2649168/
&#13;
åŸåˆ› Python æŸåŸ¹è®­æœºæ„ å”å°å¼º 2019-07-01 11:09:18
&#13;
ä»Šå¤©çš„Pythonå…¥é—¨å­¦ä¹ æ•™ç¨‹ ï¼Œä¸»è¦è·Ÿå¤§å®¶è®²æ€ä¹ˆè·å–å…¬ä¼—å·çš„å…¨éƒ¨æ–‡ç« ï¼
&#13;
æˆ‘ä»¬å¹³æ—¶é˜…è¯»å…¬ä¼—å·çš„æ–‡ç« ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜â€”â€”é˜…è¯»å†å²æ–‡ç« ä½“éªŒä¸å¥½ã€‚
&#13;
æˆ‘ä»¬çŸ¥é“çˆ¬å–å…¬ä¼—å·çš„æ–¹å¼å¸¸è§çš„æœ‰ä¸¤ç§ï¼šé€šè¿‡æœç‹—æœç´¢å»è·å–ï¼Œç¼ºç‚¹æ˜¯åªèƒ½è·å–æœ€æ–°çš„åæ¡æ¨é€æ–‡ç« ã€‚é€šè¿‡å¾®ä¿¡å…¬ä¼—å·çš„ç´ æç®¡ç†ï¼Œè·å–å…¬ä¼—å·æ–‡ç« ã€‚ç¼ºç‚¹æ˜¯éœ€è¦ç”³è¯·è‡ªå·±çš„å…¬ä¼—å·ã€‚
&#13;
ä»Šå¤©ä»‹ç»ä¸€ç§é€šè¿‡æŠ“åŒ…PCç«¯å¾®ä¿¡çš„æ–¹å¼å»è·å–å…¬ä¼—å·æ–‡ç« çš„æ–¹æ³•ã€‚ç›¸æ¯”å…¶ä»–çš„æ–¹æ³•éå¸¸æ–¹ä¾¿ã€‚
&#13;
å¦‚ä¸Šå›¾ï¼Œé€šè¿‡æŠ“åŒ…å·¥å…·è·å–å¾®ä¿¡çš„ç½‘ç»œä¿¡æ¯è¯·æ±‚ï¼Œæˆ‘ä»¬å‘ç°æ¯æ¬¡ä¸‹æ‹‰åˆ·æ–°æ–‡ç« çš„æ—¶å€™éƒ½ä¼šè¯·æ±‚ mp.weixin.qq.com/mp/xxx ï¼ˆå…¬ä¼—å·ä¸è®©æ·»åŠ ä¸»é¡µé“¾æ¥ï¼Œxxxè¡¨ç¤ºprofile_extï¼‰ è¿™ä¸ªæ¥å£ã€‚
&#13;
ç»è¿‡å¤šæ¬¡æµ‹è¯•åˆ†æï¼Œç”¨åˆ°äº†ä»¥ä¸‹å‡ ä¸ªå‚æ•°
&#13;
__biz : ç”¨æˆ·å’Œå…¬ä¼—å·ä¹‹é—´çš„å”¯ä¸€id
&#13;
uin ï¼šç”¨æˆ·çš„ç§å¯†id
&#13;
key ï¼šè¯·æ±‚çš„ç§˜é’¥ï¼Œä¸€æ®µæ—¶å€™åªä¼šå°±ä¼šå¤±æ•ˆ
&#13;
offset ï¼šåç§»é‡
&#13;
count ï¼šæ¯æ¬¡è¯·æ±‚çš„æ¡æ•°
&#13;
æ•°æ®å¦‚ä¸‹
&#13;
{
&#13;
 "ret": 0,
&#13;
 "errmsg": "ok", # è¯·æ±‚çŠ¶æ€
&#13;
 "msg_count": 10, # ä¿¡æ¯æ¡æ•°
&#13;
 "can_msg_continue": 1, # æ˜¯å¦è¿˜å¯ä»¥ç»§ç»­è·å–ï¼Œ1ä»£è¡¨å¯ä»¥ã€‚0ä»£è¡¨ä¸å¯ä»¥ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€é¡µ
&#13;
 "general_msg_list": "{"list":[]}", # å…¬ä¼—å·æ–‡æœ¬ä¿¡æ¯
&#13;
 "next_offset": 20, 
&#13;
 "video_count": 1,
&#13;
 "use_video_tab": 1,
&#13;
 "real_type": 0,
&#13;
 "home_page_list": []
&#13;
}
&#13;
éƒ¨åˆ†ä»£ç å¦‚ä¸‹
&#13;
 params = {
&#13;
 '__biz': biz,
&#13;
 'uin': uin,
&#13;
 'key': key,
&#13;
 'offset': offset,
&#13;
 'count': count,
&#13;
 'action': 'getmsg',
&#13;
 'f': 'json'
&#13;
 }
&#13;
 headers = {
&#13;
 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36'
&#13;
 }
&#13;
 response = requests.get(url=url, params=params, headers=headers)
&#13;
 resp_json = response.json()
&#13;
 if resp_json.get('errmsg') == 'ok':
&#13;
 resp_json = response.json()
&#13;
 # æ˜¯å¦è¿˜æœ‰åˆ†é¡µæ•°æ®ï¼Œ ç”¨äºåˆ¤æ–­returnçš„å€¼
&#13;
 can_msg_continue = resp_json['can_msg_continue']
&#13;
 # å½“å‰åˆ†é¡µæ–‡ç« æ•°
&#13;
 msg_count = resp_json['msg_count']
&#13;
 general_msg_list = json.loads(resp_json['general_msg_list'])
&#13;
 list = general_msg_list.get('list')
&#13;
 print(list, "**************")
&#13;
æœ€åæ‰“å°çš„listå°±æ˜¯å…¬ä¼—å·çš„æ–‡ç« ä¿¡æ¯è¯¦æƒ…ã€‚åŒ…æ‹¬æ ‡é¢˜(titile)ã€æ‘˜è¦(digest)ã€æ–‡ç« åœ°å€(content_url)ã€é˜…è¯»åŸæ–‡åœ°å€(source_url)ã€å°é¢å›¾(cover)ã€ä½œè€…(author)ç­‰ç­‰...
&#13;
è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š
&#13;
[{
&#13;
 "comm_msg_info": {
&#13;
 "id": 1000000038,
&#13;
 "type": 49,
&#13;
 "datetime": 1560474000,
&#13;
 "fakeid": "3881067844",
&#13;
 "status": 2,
&#13;
 "content": ""
&#13;
 },
&#13;
 "app_msg_ext_info": {
&#13;
 "title": "å…¥é—¨çˆ¬è™«ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ï¼",
&#13;
 "digest": "å…¥é—¨çˆ¬è™«ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ï¼",
&#13;
 "content": "",
&#13;
 "fileid": 0,
&#13;
 "content_url": "http:XXXXXX",
&#13;
 "source_url": "",
&#13;
 "cover": "I5kME6BVXeLibZDUhsiaEYiaX7zOoibxa9sb4stIwrfuqID5ttmiaoVAFyxKF6IjOCyl22vg8n2NPv98ibow\/0?wx_fmt=jpeg",
&#13;
 "subtype": 9,
&#13;
 "is_multi": 0,
&#13;
 "multi_app_msg_item_list": [],
&#13;
 "author": "Python3X",
&#13;
 "copyright_stat": 11,
&#13;
 "duration": 0,
&#13;
 "del_flag": 1,
&#13;
 "item_show_type": 0,
&#13;
 "audio_fileid": 0,
&#13;
 "play_url": "",
&#13;
 "malicious_title_reason_id": 0,
&#13;
 "malicious_content_type": 0
&#13;
 }
&#13;
},{...},{...},{...},{...},{...},{...},{...},{...},{...}]
&#13;
è·å–æ•°æ®ä¹‹åï¼Œå¯ä»¥ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œä¹Ÿå¯ä»¥å°†æ–‡ç« ä¿å­˜åœ¨PDFä¸­ã€‚
&#13;
1ã€ä¿å­˜åœ¨Mongoä¸­
&#13;
# Mongoé…ç½®
&#13;
conn = MongoClient('127.0.0.1', 27017)
&#13;
db = conn.wx #è¿æ¥wxæ•°æ®åº“ï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º
&#13;
mongo_wx = db.article #ä½¿ç”¨articleé›†åˆï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º
&#13;
for i in list:
&#13;
 app_msg_ext_info = i['app_msg_ext_info']
&#13;
 # æ ‡é¢˜
&#13;
 title = app_msg_ext_info['title']
&#13;
 # æ–‡ç« åœ°å€
&#13;
 content_url = app_msg_ext_info['content_url']
&#13;
 # å°é¢å›¾
&#13;
 cover = app_msg_ext_info['cover']
&#13;
 # å‘å¸ƒæ—¶é—´
&#13;
 datetime = i['comm_msg_info']['datetime']
&#13;
 datetime = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(datetime))
&#13;
 mongo_wx.insert({
&#13;
 'title': title,
&#13;
 'content_url': content_url,
&#13;
 'cover': cover,
&#13;
 'datetime': datetime
&#13;
 })
&#13;
ç»“æœå¦‚ä¸‹
&#13;
2ã€å¯¼å…¥åˆ°PDFæ–‡ä»¶ä¸­
&#13;
Python3ä¸­å¸¸ç”¨çš„æ“ä½œPDFçš„åº“æœ‰python-pdfå’Œpdfkitã€‚æˆ‘ç”¨äº†pdfkitè¿™ä¸ªæ¨¡å—å¯¼å‡ºpdfæ–‡ä»¶ã€‚
&#13;
pdfkitæ˜¯å·¥å…·åŒ…Wkhtmltopdfçš„å°è£…ç±»ï¼Œå› æ­¤éœ€è¦å®‰è£…Wkhtmltopdfæ‰èƒ½ä½¿ç”¨ã€‚
&#13;
å¯ä»¥è®¿é—® https://wkhtmltopdf.org/downloads.html ä¸‹è½½å’Œæ“ä½œç³»ç»ŸåŒ¹é…çš„å·¥å…·åŒ…ã€‚
&#13;
å®ç°ä»£ç ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ä¼ å…¥å¯¼å…¥æ–‡ä»¶çš„urlå³å¯ã€‚
&#13;
å®‰è£…pdfkitåº“
&#13;
pip3 install pdfkit -i http://pypi.douban.com/simple --trusted-host pypi.douban.com
&#13;
import pdfkit
&#13;
pdfkit.from_url('å…¬ä¼—å·æ–‡ç« åœ°å€', 'out.pdf')
&#13;
è¿è¡Œä¹‹åæˆåŠŸå¯¼å‡ºpdfæ–‡ä»¶ã€‚
&#13;
å®Œæ•´ä»£ç 
&#13;
import requests
&#13;
import json
&#13;
import time
&#13;
from pymongo import MongoClient
&#13;
url = 'http://mp.weixin.qq.com/mp/xxx'ï¼ˆå…¬ä¼—å·ä¸è®©æ·»åŠ ä¸»é¡µé“¾æ¥ï¼Œxxxè¡¨ç¤ºprofile_ext)
&#13;
# Mongoé…ç½®
&#13;
conn = MongoClient('127.0.0.1', 27017)
&#13;
db = conn.wx #è¿æ¥wxæ•°æ®åº“ï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º
&#13;
mongo_wx = db.article #ä½¿ç”¨articleé›†åˆï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º
&#13;
def get_wx_article(biz, uin, key, index=0, count=10):
&#13;
 offset = (index + 1) * count
&#13;
 params = {
&#13;
 '__biz': biz,
&#13;
 'uin': uin,
&#13;
 'key': key,
&#13;
 'offset': offset,
&#13;
 'count': count,
&#13;
 'action': 'getmsg',
&#13;
 'f': 'json'
&#13;
 }
&#13;
 headers = {
&#13;
 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36'
&#13;
 }
&#13;
 response = requests.get(url=url, params=params, headers=headers)
&#13;
 resp_json = response.json()
&#13;
 if resp_json.get('errmsg') == 'ok':
&#13;
 resp_json = response.json()
&#13;
 # æ˜¯å¦è¿˜æœ‰åˆ†é¡µæ•°æ®ï¼Œ ç”¨äºåˆ¤æ–­returnçš„å€¼
&#13;
 can_msg_continue = resp_json['can_msg_continue']
&#13;
 # å½“å‰åˆ†é¡µæ–‡ç« æ•°
&#13;
 msg_count = resp_json['msg_count']
&#13;
 general_msg_list = json.loads(resp_json['general_msg_list'])
&#13;
 list = general_msg_list.get('list')
&#13;
 print(list, "**************")
&#13;
 for i in list:
&#13;
 app_msg_ext_info = i['app_msg_ext_info']
&#13;
 # æ ‡é¢˜
&#13;
 title = app_msg_ext_info['title']
&#13;
 # æ–‡ç« åœ°å€
&#13;
 content_url = app_msg_ext_info['content_url']
&#13;
 # å°é¢å›¾
&#13;
 cover = app_msg_ext_info['cover']
&#13;
 # å‘å¸ƒæ—¶é—´
&#13;
 datetime = i['comm_msg_info']['datetime']
&#13;
 datetime = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(datetime))
&#13;
 mongo_wx.insert({
&#13;
 'title': title,
&#13;
 'content_url': content_url,
&#13;
 'cover': cover,
&#13;
 'datetime': datetime
&#13;
 })
&#13;
 if can_msg_continue == 1:
&#13;
 return True
&#13;
 return False
&#13;
 else:
&#13;
 print('è·å–æ–‡ç« å¼‚å¸¸...')
&#13;
 return False
&#13;
if __name__ == '__main__':
&#13;
 biz = 'Mzg4MTA2Nzg0NA=='
&#13;
 uin = 'NDIyMTI5NDM1'
&#13;
 key = '20a680e825f03f1e7f38f326772e54e7dc0fd02ffba17e92730ba3f0a0329c5ed310b0bd55b3c0b1f122e5896c6261df2eaea4036ab5a5d32dbdbcb0a638f5f3605cf1821decf486bb6eb4d92d36c620'
&#13;
 index = 0
&#13;
 while 1:
&#13;
 print(f'å¼€å§‹æŠ“å–å…¬ä¼—å·ç¬¬{index + 1} é¡µæ–‡ç« .')
&#13;
 flag = get_wx_article(biz, uin, key, index=index)
&#13;
 # é˜²æ­¢å’Œè°ï¼Œæš‚åœ8ç§’
&#13;
 time.sleep(8)
&#13;
 index += 1
&#13;
 if not flag:
&#13;
 print('å…¬ä¼—å·æ–‡ç« å·²å…¨éƒ¨æŠ“å–å®Œæ¯•ï¼Œé€€å‡ºç¨‹åº.')
&#13;
 break
&#13;
 print(f'..........å‡†å¤‡æŠ“å–å…¬ä¼—å·ç¬¬{index + 1} é¡µæ–‡ç« .')</description>
      <content:encoded><![CDATA[<p><b>ç¥ç§˜ç”·å­A: </b><br>
<span>è¿˜åœ¨å¤åˆ¶é»è´´ï¼Ÿ50è¡ŒPythonä»£ç ï¼Œæ•™ä½ è·å–å…¬ä¼—å·å…¨éƒ¨æ–‡ç« </span><br>
<span> æœ¬å¸–æœ€åç”± ç¥ç§˜ç”·å­A äº 2019-7-3 11:56 ç¼–è¾‘ </span><br>
<span>http://blog.itpub.net/69923331/viewspace-2649168/</span><br>
<span>åŸåˆ› Python æŸåŸ¹è®­æœºæ„ å”å°å¼º 2019-07-01 11:09:18</span><br>
<span>ä»Šå¤©çš„Pythonå…¥é—¨å­¦ä¹ æ•™ç¨‹ ï¼Œä¸»è¦è·Ÿå¤§å®¶è®²æ€ä¹ˆè·å–å…¬ä¼—å·çš„å…¨éƒ¨æ–‡ç« ï¼</span><br>
<span>æˆ‘ä»¬å¹³æ—¶é˜…è¯»å…¬ä¼—å·çš„æ–‡ç« ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜â€”â€”é˜…è¯»å†å²æ–‡ç« ä½“éªŒä¸å¥½ã€‚</span><br>
<span>æˆ‘ä»¬çŸ¥é“çˆ¬å–å…¬ä¼—å·çš„æ–¹å¼å¸¸è§çš„æœ‰ä¸¤ç§ï¼šé€šè¿‡æœç‹—æœç´¢å»è·å–ï¼Œç¼ºç‚¹æ˜¯åªèƒ½è·å–æœ€æ–°çš„åæ¡æ¨é€æ–‡ç« ã€‚é€šè¿‡å¾®ä¿¡å…¬ä¼—å·çš„ç´ æç®¡ç†ï¼Œè·å–å…¬ä¼—å·æ–‡ç« ã€‚ç¼ºç‚¹æ˜¯éœ€è¦ç”³è¯·è‡ªå·±çš„å…¬ä¼—å·ã€‚</span><br>
<span>ä»Šå¤©ä»‹ç»ä¸€ç§é€šè¿‡æŠ“åŒ…PCç«¯å¾®ä¿¡çš„æ–¹å¼å»è·å–å…¬ä¼—å·æ–‡ç« çš„æ–¹æ³•ã€‚ç›¸æ¯”å…¶ä»–çš„æ–¹æ³•éå¸¸æ–¹ä¾¿ã€‚</span><br>
<span>å¦‚ä¸Šå›¾ï¼Œé€šè¿‡æŠ“åŒ…å·¥å…·è·å–å¾®ä¿¡çš„ç½‘ç»œä¿¡æ¯è¯·æ±‚ï¼Œæˆ‘ä»¬å‘ç°æ¯æ¬¡ä¸‹æ‹‰åˆ·æ–°æ–‡ç« çš„æ—¶å€™éƒ½ä¼šè¯·æ±‚ mp.weixin.qq.com/mp/xxx ï¼ˆå…¬ä¼—å·ä¸è®©æ·»åŠ ä¸»é¡µé“¾æ¥ï¼Œxxxè¡¨ç¤ºprofile_extï¼‰ è¿™ä¸ªæ¥å£ã€‚</span><br>
<span>ç»è¿‡å¤šæ¬¡æµ‹è¯•åˆ†æï¼Œç”¨åˆ°äº†ä»¥ä¸‹å‡ ä¸ªå‚æ•°</span><br>
<span>__biz : ç”¨æˆ·å’Œå…¬ä¼—å·ä¹‹é—´çš„å”¯ä¸€id</span><br>
<span>uin ï¼šç”¨æˆ·çš„ç§å¯†id</span><br>
<span>key ï¼šè¯·æ±‚çš„ç§˜é’¥ï¼Œä¸€æ®µæ—¶å€™åªä¼šå°±ä¼šå¤±æ•ˆ</span><br>
<span>offset ï¼šåç§»é‡</span><br>
<span>count ï¼šæ¯æ¬¡è¯·æ±‚çš„æ¡æ•°</span><br>
<span>æ•°æ®å¦‚ä¸‹</span><br>
<span>{</span><br>
<span> "ret": 0,</span><br>
<span> "errmsg": "ok", # è¯·æ±‚çŠ¶æ€</span><br>
<span> "msg_count": 10, # ä¿¡æ¯æ¡æ•°</span><br>
<span> "can_msg_continue": 1, # æ˜¯å¦è¿˜å¯ä»¥ç»§ç»­è·å–ï¼Œ1ä»£è¡¨å¯ä»¥ã€‚0ä»£è¡¨ä¸å¯ä»¥ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€é¡µ</span><br>
<span> "general_msg_list": "{"list":[]}", # å…¬ä¼—å·æ–‡æœ¬ä¿¡æ¯</span><br>
<span> "next_offset": 20, </span><br>
<span> "video_count": 1,</span><br>
<span> "use_video_tab": 1,</span><br>
<span> "real_type": 0,</span><br>
<span> "home_page_list": []</span><br>
<span>}</span><br>
<span>éƒ¨åˆ†ä»£ç å¦‚ä¸‹</span><br>
<span> params = {</span><br>
<span> '__biz': biz,</span><br>
<span> 'uin': uin,</span><br>
<span> 'key': key,</span><br>
<span> 'offset': offset,</span><br>
<span> 'count': count,</span><br>
<span> 'action': 'getmsg',</span><br>
<span> 'f': 'json'</span><br>
<span> }</span><br>
<span> headers = {</span><br>
<span> 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36'</span><br>
<span> }</span><br>
<span> response = requests.get(url=url, params=params, headers=headers)</span><br>
<span> resp_json = response.json()</span><br>
<span> if resp_json.get('errmsg') == 'ok':</span><br>
<span> resp_json = response.json()</span><br>
<span> # æ˜¯å¦è¿˜æœ‰åˆ†é¡µæ•°æ®ï¼Œ ç”¨äºåˆ¤æ–­returnçš„å€¼</span><br>
<span> can_msg_continue = resp_json['can_msg_continue']</span><br>
<span> # å½“å‰åˆ†é¡µæ–‡ç« æ•°</span><br>
<span> msg_count = resp_json['msg_count']</span><br>
<span> general_msg_list = json.loads(resp_json['general_msg_list'])</span><br>
<span> list = general_msg_list.get('list')</span><br>
<span> print(list, "**************")</span><br>
<span>æœ€åæ‰“å°çš„listå°±æ˜¯å…¬ä¼—å·çš„æ–‡ç« ä¿¡æ¯è¯¦æƒ…ã€‚åŒ…æ‹¬æ ‡é¢˜(titile)ã€æ‘˜è¦(digest)ã€æ–‡ç« åœ°å€(content_url)ã€é˜…è¯»åŸæ–‡åœ°å€(source_url)ã€å°é¢å›¾(cover)ã€ä½œè€…(author)ç­‰ç­‰...</span><br>
<span>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</span><br>
<span>[{</span><br>
<span> "comm_msg_info": {</span><br>
<span> "id": 1000000038,</span><br>
<span> "type": 49,</span><br>
<span> "datetime": 1560474000,</span><br>
<span> "fakeid": "3881067844",</span><br>
<span> "status": 2,</span><br>
<span> "content": ""</span><br>
<span> },</span><br>
<span> "app_msg_ext_info": {</span><br>
<span> "title": "å…¥é—¨çˆ¬è™«ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ï¼",</span><br>
<span> "digest": "å…¥é—¨çˆ¬è™«ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ï¼",</span><br>
<span> "content": "",</span><br>
<span> "fileid": 0,</span><br>
<span> "content_url": "http:XXXXXX",</span><br>
<span> "source_url": "",</span><br>
<span> "cover": "I5kME6BVXeLibZDUhsiaEYiaX7zOoibxa9sb4stIwrfuqID5ttmiaoVAFyxKF6IjOCyl22vg8n2NPv98ibow\/0?wx_fmt=jpeg",</span><br>
<span> "subtype": 9,</span><br>
<span> "is_multi": 0,</span><br>
<span> "multi_app_msg_item_list": [],</span><br>
<span> "author": "Python3X",</span><br>
<span> "copyright_stat": 11,</span><br>
<span> "duration": 0,</span><br>
<span> "del_flag": 1,</span><br>
<span> "item_show_type": 0,</span><br>
<span> "audio_fileid": 0,</span><br>
<span> "play_url": "",</span><br>
<span> "malicious_title_reason_id": 0,</span><br>
<span> "malicious_content_type": 0</span><br>
<span> }</span><br>
<span>},{...},{...},{...},{...},{...},{...},{...},{...},{...}]</span><br>
<span>è·å–æ•°æ®ä¹‹åï¼Œå¯ä»¥ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œä¹Ÿå¯ä»¥å°†æ–‡ç« ä¿å­˜åœ¨PDFä¸­ã€‚</span><br>
<span>1ã€ä¿å­˜åœ¨Mongoä¸­</span><br>
<span># Mongoé…ç½®</span><br>
<span>conn = MongoClient('127.0.0.1', 27017)</span><br>
<span>db = conn.wx #è¿æ¥wxæ•°æ®åº“ï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º</span><br>
<span>mongo_wx = db.article #ä½¿ç”¨articleé›†åˆï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º</span><br>
<span>for i in list:</span><br>
<span> app_msg_ext_info = i['app_msg_ext_info']</span><br>
<span> # æ ‡é¢˜</span><br>
<span> title = app_msg_ext_info['title']</span><br>
<span> # æ–‡ç« åœ°å€</span><br>
<span> content_url = app_msg_ext_info['content_url']</span><br>
<span> # å°é¢å›¾</span><br>
<span> cover = app_msg_ext_info['cover']</span><br>
<span> # å‘å¸ƒæ—¶é—´</span><br>
<span> datetime = i['comm_msg_info']['datetime']</span><br>
<span> datetime = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(datetime))</span><br>
<span> mongo_wx.insert({</span><br>
<span> 'title': title,</span><br>
<span> 'content_url': content_url,</span><br>
<span> 'cover': cover,</span><br>
<span> 'datetime': datetime</span><br>
<span> })</span><br>
<span>ç»“æœå¦‚ä¸‹</span><br>
<span>2ã€å¯¼å…¥åˆ°PDFæ–‡ä»¶ä¸­</span><br>
<span>Python3ä¸­å¸¸ç”¨çš„æ“ä½œPDFçš„åº“æœ‰python-pdfå’Œpdfkitã€‚æˆ‘ç”¨äº†pdfkitè¿™ä¸ªæ¨¡å—å¯¼å‡ºpdfæ–‡ä»¶ã€‚</span><br>
<span>pdfkitæ˜¯å·¥å…·åŒ…Wkhtmltopdfçš„å°è£…ç±»ï¼Œå› æ­¤éœ€è¦å®‰è£…Wkhtmltopdfæ‰èƒ½ä½¿ç”¨ã€‚</span><br>
<span>å¯ä»¥è®¿é—® https://wkhtmltopdf.org/downloads.html ä¸‹è½½å’Œæ“ä½œç³»ç»ŸåŒ¹é…çš„å·¥å…·åŒ…ã€‚</span><br>
<span>å®ç°ä»£ç ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ä¼ å…¥å¯¼å…¥æ–‡ä»¶çš„urlå³å¯ã€‚</span><br>
<span>å®‰è£…pdfkitåº“</span><br>
<span>pip3 install pdfkit -i http://pypi.douban.com/simple --trusted-host pypi.douban.com</span><br>
<span>import pdfkit</span><br>
<span>pdfkit.from_url('å…¬ä¼—å·æ–‡ç« åœ°å€', 'out.pdf')</span><br>
<span>è¿è¡Œä¹‹åæˆåŠŸå¯¼å‡ºpdfæ–‡ä»¶ã€‚</span><br>
<span>å®Œæ•´ä»£ç </span><br>
<span>import requests</span><br>
<span>import json</span><br>
<span>import time</span><br>
<span>from pymongo import MongoClient</span><br>
<span>url = 'http://mp.weixin.qq.com/mp/xxx'ï¼ˆå…¬ä¼—å·ä¸è®©æ·»åŠ ä¸»é¡µé“¾æ¥ï¼Œxxxè¡¨ç¤ºprofile_ext)</span><br>
<span># Mongoé…ç½®</span><br>
<span>conn = MongoClient('127.0.0.1', 27017)</span><br>
<span>db = conn.wx #è¿æ¥wxæ•°æ®åº“ï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º</span><br>
<span>mongo_wx = db.article #ä½¿ç”¨articleé›†åˆï¼Œæ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»º</span><br>
<span>def get_wx_article(biz, uin, key, index=0, count=10):</span><br>
<span> offset = (index + 1) * count</span><br>
<span> params = {</span><br>
<span> '__biz': biz,</span><br>
<span> 'uin': uin,</span><br>
<span> 'key': key,</span><br>
<span> 'offset': offset,</span><br>
<span> 'count': count,</span><br>
<span> 'action': 'getmsg',</span><br>
<span> 'f': 'json'</span><br>
<span> }</span><br>
<span> headers = {</span><br>
<span> 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36'</span><br>
<span> }</span><br>
<span> response = requests.get(url=url, params=params, headers=headers)</span><br>
<span> resp_json = response.json()</span><br>
<span> if resp_json.get('errmsg') == 'ok':</span><br>
<span> resp_json = response.json()</span><br>
<span> # æ˜¯å¦è¿˜æœ‰åˆ†é¡µæ•°æ®ï¼Œ ç”¨äºåˆ¤æ–­returnçš„å€¼</span><br>
<span> can_msg_continue = resp_json['can_msg_continue']</span><br>
<span> # å½“å‰åˆ†é¡µæ–‡ç« æ•°</span><br>
<span> msg_count = resp_json['msg_count']</span><br>
<span> general_msg_list = json.loads(resp_json['general_msg_list'])</span><br>
<span> list = general_msg_list.get('list')</span><br>
<span> print(list, "**************")</span><br>
<span> for i in list:</span><br>
<span> app_msg_ext_info = i['app_msg_ext_info']</span><br>
<span> # æ ‡é¢˜</span><br>
<span> title = app_msg_ext_info['title']</span><br>
<span> # æ–‡ç« åœ°å€</span><br>
<span> content_url = app_msg_ext_info['content_url']</span><br>
<span> # å°é¢å›¾</span><br>
<span> cover = app_msg_ext_info['cover']</span><br>
<span> # å‘å¸ƒæ—¶é—´</span><br>
<span> datetime = i['comm_msg_info']['datetime']</span><br>
<span> datetime = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(datetime))</span><br>
<span> mongo_wx.insert({</span><br>
<span> 'title': title,</span><br>
<span> 'content_url': content_url,</span><br>
<span> 'cover': cover,</span><br>
<span> 'datetime': datetime</span><br>
<span> })</span><br>
<span> if can_msg_continue == 1:</span><br>
<span> return True</span><br>
<span> return False</span><br>
<span> else:</span><br>
<span> print('è·å–æ–‡ç« å¼‚å¸¸...')</span><br>
<span> return False</span><br>
<span>if __name__ == '__main__':</span><br>
<span> biz = 'Mzg4MTA2Nzg0NA=='</span><br>
<span> uin = 'NDIyMTI5NDM1'</span><br>
<span> key = '20a680e825f03f1e7f38f326772e54e7dc0fd02ffba17e92730ba3f0a0329c5ed310b0bd55b3c0b1f122e5896c6261df2eaea4036ab5a5d32dbdbcb0a638f5f3605cf1821decf486bb6eb4d92d36c620'</span><br>
<span> index = 0</span><br>
<span> while 1:</span><br>
<span> print(f'å¼€å§‹æŠ“å–å…¬ä¼—å·ç¬¬{index + 1} é¡µæ–‡ç« .')</span><br>
<span> flag = get_wx_article(biz, uin, key, index=index)</span><br>
<span> # é˜²æ­¢å’Œè°ï¼Œæš‚åœ8ç§’</span><br>
<span> time.sleep(8)</span><br>
<span> index += 1</span><br>
<span> if not flag:</span><br>
<span> print('å…¬ä¼—å·æ–‡ç« å·²å…¨éƒ¨æŠ“å–å®Œæ¯•ï¼Œé€€å‡ºç¨‹åº.')</span><br>
<span> break</span><br>
<span> print(f'..........å‡†å¤‡æŠ“å–å…¬ä¼—å·ç¬¬{index + 1} é¡µæ–‡ç« .')</span><br>
</p><p><b>ç‚½åäºŒç¿¼: </b><br>
<span>è´´ä¸ªpythonä»£ç è¿ç¼©è¿›éƒ½æ²¡æœ‰è¿™æ˜¯æ‹‰å±ä¸å¸¦çº¸å•Š</span><br>
</p><p><b>Prushka: </b><br>
<span>æˆ‘çŸ¥é“ä½ æƒ³å¬å”¤è°@CAMUS.net </span><br>
</p><p><b>uswhzh: </b><br>
<span>ç‚½åäºŒç¿¼ å‘è¡¨äº 2019-7-3 11:09</span><br>
<span>è´´ä¸ªpythonä»£ç è¿ç¼©è¿›éƒ½æ²¡æœ‰è¿™æ˜¯æ‹‰å±ä¸å¸¦çº¸å•Š</span><br>
<span>æ˜¯;å·ï¼Œå…¨æ”¹æˆå…¨è§’äº†ã€‚</span><br>
</p><p><b>ç„šæ¢: </b><br>
<span>ç¥ç§˜ç”·å­A å‘è¡¨äº 2019-7-3 11:07</span><br>
<span>http://blog.itpub.net/69923331/viewspace-2649168/</span><br>
<span>åŸåˆ› Python åƒé”‹Pythonå”å°å¼º 2019-07-01 11:09:18</span><br>
<span>åƒå³°åŸ¹è®­æœºæ„ã€‚ã€‚æœ€è¿‘å¤šä¸ªè®ºå›ç¤¾åŒºå¸¸çœ‹åˆ°</span><br>
</p><p><b>ç¥ç§˜ç”·å­A: </b><br>
<span>ç„šæ¢ å‘è¡¨äº 2019-7-3 11:46</span><br>
<span>åƒå³°åŸ¹è®­æœºæ„ã€‚ã€‚æœ€è¿‘å¤šä¸ªè®ºå›ç¤¾åŒºå¸¸çœ‹åˆ°</span><br>
<span>åƒé”‹17å¹´æ‹¿çš„æˆ˜ç•¥æŠ•èµ„ï¼Œç°åœ¨åœ¨åšIPOå†²ä¸šç»©ã€‚æ„Ÿè°¢æé†’ï¼Œæˆ‘æŠŠè½¯å¹¿å»äº†ï¼Œä¹‹å‰æ²¡æ³¨æ„ã€‚</span><br>
</p><p><b>wardenlym: </b><br>
<span>ä½ ä¸å»çœ‹æ¥å£æ–‡æ¡£ï¼Œä½ åˆ†æä½ ğŸ´å‘¢ï¼Ÿ</span><br>
</p><p><b>CAMUS.net: </b><br>
<span>Prushka å‘è¡¨äº 2019-7-3 11:12</span><br>
<span>æˆ‘çŸ¥é“ä½ æƒ³å¬å”¤è°@CAMUS.net</span><br>
<span>â€œå­”åŒ—æµ·çŸ¥ä¸–é—´æœ‰åˆ˜å¤‡è€¶ï¼Ÿâ€</span><br>
</p><p><b>Diabolosis: </b><br>
<span>æˆ‘æ€€ç–‘ä½ åœ¨æ‰“å¹¿å‘Š</span><br>
<span>â€”â€” æ¥è‡ª samsung SM-G9300, Android 8.0.0ä¸Šçš„ S1Next-é¹…ç‰ˆ v2.0.4</span><br>
</p><p><b>ã™ã´ã±ã‚‰: </b><br>
<span>è¯´å§ç¾¤å·å¤šå°‘ï¼Œå¤§å®¶ä¸€èµ·ç½‘èµš</span><br>
</p><p><b>zievod: </b><br>
<span>ç¥ç§˜ç”·å­A å‘è¡¨äº 2019-7-3 11:56</span><br>
<span>åƒé”‹17å¹´æ‹¿çš„æˆ˜ç•¥æŠ•èµ„ï¼Œç°åœ¨åœ¨åšIPOå†²ä¸šç»©ã€‚æ„Ÿè°¢æé†’ï¼Œæˆ‘æŠŠè½¯å¹¿å»äº†ï¼Œä¹‹å‰æ²¡æ³¨æ„ã€‚ ...</span><br>
<span>ç„¶åä½ ä»¬å›å¤è¿˜æ˜¯å¸¦ç€å…¬å¸åå­—å•Š</span><br>
<span>ç®—ä¸ç®—è„±è£¤å­æ”¾å±</span><br>
<span>â€”â€” æ¥è‡ª HUAWEI MHA-AL00, Android 8.0.0ä¸Šçš„ S1Next-é¹…ç‰ˆ v2.1.2</span><br>
</p><p><b>é˜¿å®…é†’é†’: </b><br>
<span>æˆ‘ä¸æ‡‚ç¼–ç¨‹ï¼Œå°±æƒ³é—®é—®å¯ä»¥ç”¨æ¥æ‰’æŸäº›ç½‘ç«™çš„å°è§†é¢‘ä¹ˆã€‚</span><br>
</p><p><b>wardenlym: </b><br>
<span>CAMUS.net å‘è¡¨äº 2019-7-3 14:53</span><br>
<span>â€œå­”åŒ—æµ·çŸ¥ä¸–é—´æœ‰åˆ˜å¤‡è€¶ï¼Ÿâ€</span><br>
<span>è¿™ä¿©ç¼–ç¨‹å¸¦å¸ˆä¹Ÿä¸çŸ¥ä»å“ªå†’å‡ºæ¥çš„ï¼Œå¤©å¤©å‘æ˜äº›è¯ºè´å°”æ™ºå•†å¥–æˆæœï¼Œéƒ½åˆ†ä¸æ¸…æ˜¯trollè¿˜æ˜¯æ™ºåŠ›æœ‰é—®é¢˜</span><br>
</p>]]></content:encoded>
      <guid isPermaLink="false">1843945[0-50]</guid>
    </item>
  </channel>
</rss>
